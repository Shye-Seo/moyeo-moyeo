<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이벤터즈랩(eventusLAB)</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css" />
</head>
<body>
	<input type="hidden" th:value="${event_id}" id="event_id">
	<div class="top_div">
		<div id="total">총 지원자 수 <span style="color: #DD5067" th:text="${applicant_count}"></span> 명</div>
	</div>
	<div class="application_list">
		<div id="list" th:each="list : ${application_list}">
			<input type="hidden" th:value="${list.id}" id="staff_id">
			<img src="/imgs/trash_can.svg" id="trash_icon" th:if="${list.result == '대기중'}" th:onclick="'rejectAccept('+${list.id}+')'">
			<div id="each_">
			<div class="img_div">
				<img src="/imgs/profile_none_img.svg" id="profile_img">
			</div>
			<div class="personal_info">
				<div id="personal_div" class="upper_div">
					<img src="/imgs/personal_icon.svg" id="icon">
					<p th:text="${list.user_name} + '(' + ${list.staff_age} + '세)'"></p>
				</div>
				<div id="personal_div">
					<img src="/imgs/phone_icon.svg" id="icon">
					<p th:text="${list.staff_phone}"></p>
				</div>
			</div>
			<div id="line"></div>
			<div class="career_info">
				<div class="upper_div"><p>행사경력</p></div>
				<div><p th:text="${list.career_count} + ' 회'"></p></div>
			</div>
			<div id="line"></div>
			<div class="address_info">
				<div class="upper_div"><p>거주지</p></div>
				<div><p th:text="${list.staff_address}"></p></div>
			</div>
			<div id="line"></div>
			<div class="btn_div">
				<button type="button" id="accept_btn" th:onclick="'acceptApplicant('+${list.id}+')'" th:if="${list.result == '대기중'}">수락</button>
				<button type="button" id="complete_btn" th:onclick="'undo('+${list.id}+')'" th:if="${list.result == '합격'}">완료</button>
				<button type="button" id="undo_btn" th:onclick="'undo('+${list.id}+')'" th:if="${list.result == '불합격'}">취소</button>
				<span id="resume_open">이력서보기</span>
			</div>
			</div>
		</div>
	</div>
	<script>
		function acceptApplicant(staff_id)  {
		  var event_id = $("#event_id").val();
		  
		  $.ajax({
				url : "/accept_applicant",
				type : 'post',
				data : {
					staff_id:staff_id,
					event_id:event_id
				},
				success: function(){
					location.href="/application_modal?id="+event_id;
				}
			});
		}
		
		function undo(staff_id)  {
			  var event_id = $("#event_id").val();
			  
			  $.ajax({
					url : "/accept_applicant_cancel",
					type : 'post',
					data : {
						staff_id:staff_id,
						event_id:event_id
					},
					success: function(){
						location.href="/application_modal?id="+event_id;
					}
				});
			}
		
		function rejectAccept(staff_id)  {
			  var event_id = $("#event_id").val();
			  
			  $.ajax({
					url : "/reject_applicant",
					type : 'post',
					data : {
						staff_id:staff_id,
						event_id:event_id
					},
					success: function(){
						location.href="/application_modal?id="+event_id;
					}
				});
			}
  </script>
</body>
</html>