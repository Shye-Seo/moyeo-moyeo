<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이벤터즈랩(eventusLAB)</title>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <link rel="stylesheet" href="/css/manage_staff.css">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css" />
</head>
<body>

    <div id="wrap">
        <div th:replace="~{common/sideforstaff :: sidebar_manage ('manage_career_forstaff')}"></div>
        <form th:insert="~{contract_file :: modal}" action="contract_check" id="contract" class="contract"></form>

        <!-- main -->
        <div class="content">
            <div class="container">
                <div class="page-header">
                    <div class="page-title">
                        <span>이력관리</span>
                    </div>
                </div>

                <div class="detail_bar">
                    <div class="detail1">
                        <img src="material-view-list.svg">
                        <input type="button" value="직원현황">
                    </div>
                    <div class="detail2">
                        <img src="material-view-list.svg">
                        <input type="button" value="나의이력서">
                    </div>
                    
                </div>

                <div class="area">
                    <div class="search_area">
                        <input type="text" class="calendar">
                        <input type="text" class="word_search">
                    </div>
                    

                    <ul class="list">
                        <ol>
                            <li>No</li>
                            <li>행사명</li>
                            <li>행사기간</li>
                            <li>합격여부</li>
                            <li>근로계약서</li>
                        </ol>
                        <!-- db에서 가져온 mastervo 데이터를 thymeleaf를 사용하여 출력 -->
                        <ol th:block th:each="career : ${career_list}">
                            <li class="applicationList"></li>
                            <li th:text="${career.event_title}"></li>
                            <li th:text="${career.event_startDate} + ' - ' + ${career.event_endDate}"></li>
                            <li th:text="${career.application_result}"></li>
                            <li><input type="button" value="미등록"></li>
                        </ol>
                            

                    </ul>
                </div>


                <!-- 페이징 처리(Unix 참조) -->
                <div>
                    <ul>
                        <!-- 이전 -->

                        <!-- 번호 -->

                        <!-- 다음 -->

                    </ul>
                </div>
            </div>
        </div>
    </div>
    <style>
        pre {
            height: 300px;
            overflow-y: scroll;
        }

        #modal1,
        #modal2 {
            display:none;
            position:fixed;
            right:0;
            width:50%;
            height:100%;
            background-color:#FFFFFF;
            border:1px solid #DDDDDD;
            border-radius: 3px;
            opacity: 1;
            z-index:1;
        }

    </style>
    <script>
        var num = [[${career_num}]];
        // class="applicationList"에 num값을 넣어줌
        $(".applicationList").each(function(){
            $(this).text(num);
            num--;
        });

        // 근로계약서 미등록 클릭시 모달창 띄우기
        $(function() {

            // 근로계약서 등록 버튼 클릭 시
            $("input[name=${career.event_title}]").click(function(){
                $("#modal1").css("display", "block");
            });

            // X 버튼 클릭 시 모달창 닫기
            $("#cancel1").click(function() {
                $("#modal1").css("display", "none");
                $("#modal2").css("display", "none");
                return false;
            });
            $("#cancel2").click(function() {
                $("#modal1").css("display", "none");
                $("#modal2").css("display", "none");
                return false;
            });

            // 취소 버튼 클릭 시 모달창 닫기
            $("#reset_btn").click(function(){
                $("#modal1").css("display", "none");
                $("#modal2").css("display", "none");
            });

            // 보안 계약서 모달에서 뒤로 버튼 클릭 시 근로 계약서 모달로 이동
            $("#back_btn").click(function(){
                $("#modal1").css("display", "block");
                $("#modal2").css("display", "none");
            });

            // id가 save_btn 버튼 숨기기
            $("#save_btn").css("display", "none");


            // input태그에 type이 text인 곳에 빈칸이 있을 경우 "빈칸을 채워주세요." 라는 경고창 띄우기
            $("#next_btn").click(function() {
                $("#modal1").css("display", "none");
                $("#modal2").css("display", "block");

            });

            // 저장 버튼 클릭 시


            $('#confirm_btn').click(function() {
                var check = false;
                $("#modal2 input[type=text]").each(function() {
                    // id가 user_name1==user_name2==user_name3==user_name4 일 경우 통과
                    if ($("#user_name1").val() == $("#user_name2").val() && $("#user_name1").val() == $("#user_name3").val() && $("#user_name1").val() == $("#user_name4").val()) { check=true; }
                    else {
                        alert("이름이 일치하지 않습니다.");
                        check = false;
                        return false;
                    }

                    if ($(this).val() == "") {
                        alert("빈칸을 채워주세요.");
                        check = false;
                        return false;
                    }
                    else if ($("#staff_address1").val() != $("#staff_address2").val()) {
                        alert("주소가 일치하지 않습니다.");
                        check = false;
                        return false;
                    }
                    // identification_number1!=identification_number2 일 경우 "주민등록번호가 일치하지 않습니다." 라는 경고창 띄우기
                    else if ($("#identification_number1").val() != $("#identification_number2").val()) {
                        alert("주민등록번호가 일치하지 않습니다.");
                        check = false;
                        return false;
                    }


                    if(check) {
                        $("#contract").submit();
                    }
                });

            });
        })
    </script>

</body>
</html>
